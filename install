# Проверка и завершение процесса winws.exe с скрытием ошибок
if (Get-Process -Name "winws" -ErrorAction SilentlyContinue) {
    try {
        Stop-Process -Name "winws" -Force -ErrorAction SilentlyContinue 2>$null
    } catch {
        # Ошибка не будет отображаться
    }
} else {
    # Процесс не найден, пропуск
}

# Проверка и остановка службы Windivert с скрытием ошибок
if (Get-Service -Name "windivert" -ErrorAction SilentlyContinue) {
    try {
        Stop-Service -Name "windivert" -Force -ErrorAction SilentlyContinue 2>$null
    } catch {
        # Ошибка не будет отображаться
    }
} else {
    # Служба не найдена, пропуск
}

# Удаление службы Windivert с скрытием ошибок
if (Get-Service -Name "windivert" -ErrorAction SilentlyContinue) {
    try {
        & sc.exe delete windivert 2>$null
    } catch {
        # Ошибка не будет отображаться
    }
} else {
    # Служба не найдена, пропуск
}
$desktopPath = [System.Environment]::GetFolderPath('Desktop')
$zapretZipPath = "$env:USERPROFILE\Downloads\zapret.zip"
$zapretFolderPath = "$desktopPath\zapret"
$zipUrl = "https://github.com/vayulqq/zapret/releases/download/qedqedndndn/zapret.zip"
if (Test-Path $zapretZipPath) {
    Remove-Item $zapretZipPath -Force
}
if (Test-Path $zapretFolderPath) {
    Remove-Item $zapretFolderPath -Recurse -Force
}
Invoke-WebRequest -Uri $zipUrl -OutFile $zapretZipPath
Expand-Archive -Path $zapretZipPath -DestinationPath $desktopPath -Force
Remove-Item $zapretZipPath -Force
Stop-Process -Id $PID -Force
