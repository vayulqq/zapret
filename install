# Основной процесс
try {
    Log-Message "Начало работы скрипта."

    # Проверка существования папок
    If (-Not (Test-Path $downloadsPath)) {
        Log-Message "Папка загрузок не существует. Создаю её..."
        New-Item -ItemType Directory -Path $downloadsPath -Force | Out-Null
    }
    If (-Not (Test-Path $desktopPath)) {
        Log-Message "Папка рабочего стола не существует. Создаю её..."
        New-Item -ItemType Directory -Path $desktopPath -Force | Out-Null
    }

    # Скачивание файла
    $url = "https://github.com/vayulqq/zapret/releases/download/qedqedndndn/zapret.zip" # Убедитесь, что URL правильный
    Download-File -url $url -savePath $zipPath

    # Распаковка
    Unpack-Zip -filePath $zipPath -extractTo $desktopPath

    # Печать пути перед удалением
    Log-Message "Попытка удалить файл: $zipPath"
    
    # Удаление файла zapret.zip после распаковки
    Remove-ZipFile -filePath $zipPath
} catch {
    Log-Message "Общая ошибка: $_"
}
