# Путь до рабочего стола текущего пользователя
$desktopPath = [System.Environment]::GetFolderPath('Desktop')

# Пути к файлам и папкам
$zapretZipPath = "$env:USERPROFILE\Downloads\zapret.zip"
$zapretFolderPath = "$desktopPath\zapret"

# URL для скачивания архива
$zipUrl = "https://github.com/vayulqq/zapret/releases/download/qedqedndndn/zapret.zip"

# Проверка на наличие архива zapret.zip в папке "Загрузки" и папки zapret на рабочем столе
if (Test-Path $zapretZipPath) {
    # Если архив существует, распаковать его на рабочий стол
    Expand-Archive -Path $zapretZipPath -DestinationPath $desktopPath -Force

    # Удалить архив после распаковки
    Remove-Item $zapretZipPath -Force
} else {
    # Если архив не существует, скачать его с указанного URL
    Invoke-WebRequest -Uri $zipUrl -OutFile $zapretZipPath

    # Распаковать архив на рабочий стол
    Expand-Archive -Path $zapretZipPath -DestinationPath $desktopPath -Force

    # Удалить архив после распаковки
    Remove-Item $zapretZipPath -Force
}

# Проверка на наличие папки zapret на рабочем столе и удаление её
if (Test-Path $zapretFolderPath) {
    Remove-Item $zapretFolderPath -Recurse -Force
}
